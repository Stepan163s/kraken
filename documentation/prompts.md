# Система промптов (Prompts)

## Идея
Мы хотим динамически формировать «большой промпт» для ChatGPT на основе:
1. **Тематики сообщения** (политика, образование, юмор, отношения и др.).
2. **Уровня эмоциональности** (спокойный, ехидный, агрессивный и т.д.).
3. **Личности бота** (его “история”, главные ценности, часто используемые обороты речи).

## Пример структуры
```python
# Пример: pseudo-код Python
full_prompt = f"""
{STYLE_PROMPT_POLITIC}
{STYLE_PROMPT_PREFERENCES}
{STYLE_PROMPT_LENIENT}
...

Пользователь: {user_message}
Бот (твоя роль): {some_personality_details}

Ответь:
"""

## Расширение: «Распределитель стилей» (Style Router)

### Зачем нужен «Распределитель»

Мы хотим, чтобы бот не всегда говорил одинаково грубо или одинаково «по-философски». Вместо жёстких `if`-проверок, мы используем дополнительный «распределительный» модуль, который (в идеале) сам распознаёт контекст/суть вопроса и выбирает нужный набор стилей для ответа.

**Идея**:  
1. **Проверка эмоций или тематики** в сообщении (ругательства, философия, политика, личные вопросы, и т.д.).  
2. **Динамический выбор** одного или нескольких стилистических блоков (например, «Стиль злой», «Стиль философский», «Стиль ехидный», «Стиль научный»).  
3. **Объединение** выбранных стилей в общий промпт (конструктор).  
4. **Передача** итогового промпта в ChatGPT 3.5, чтобы та уже генерировала ответ в соответствии с выбранными параметрами.

### Пример формулировки «Распределителя» в промпте

Можно описать «распределительную машину» непосредственно в тексте, который подаётся ChatGPT 3.5. Допустим, у нас есть отдельная «мини-модель» (или даже сам ChatGPT), которая выступает в роли «style router» и получает инструкцию вида:

Ты – распределительная машина.
Тебе доступны такие стили (параметры):
	•	[ANGRY] – грубый стиль, если есть ругательства
	•	[PHILOSOPHICAL] – глубокие рассуждения о жизни, если речь о философии или смысле
	•	[HUMOR] – если вопрос шуточный или надо ответить весело

… (перечисляем нужные стили, их условия и особенности) …

В зависимости от темы сообщения выбери нужные параметры:
	1.	…
	2.	…
	3.	…

Затем «распределительная машина» возвращает список стилей, и мы **на лету** формируем финальный промпт, который уже пойдёт в основной вызов ChatGPT (ответ пользователю).

### Возможная структура

1. **Мини-модель (или отдельная функция)** получает от бота текст сообщения.  
2. В тексте ищутся признаки (ключевые слова, тон общения):  
   - Ругательства → [ANGRY]  
   - Философия → [PHILOSOPHICAL]  
   - Юмор → [HUMOR]  
   - Политика → [POLITIC], etc.  
3. Формируется список/строка вида `"[ANGRY], [POLITIC]"`.  
4. Подставляем в основной промпт (см. выше блоки `STYLE_PROMPT_*`), объединяя их в единый блок. Пример:
   ```python
   full_prompt = f"""
   Ты отвечаешь как: {ANGRY_PROMPT}, {PHILOSOPHICAL_PROMPT}, {HUMOR_PROMPT}

   Вопрос пользователя: {user_text}
   """

	5.	Результат отправляется в OpenAI.

Пример «Стиль злой»

(Этот блок можем вынести в отдельную переменную, типа STYLE_PROMPT_ANGRY.)

"Стиль злой":
- Говори дерзко, можешь оскорблять, но старайся не упоминать личные данные собеседника.
- Нередко используй «мягкие»/«панибратские» ругательства типа «дурак» или «тупица».
- Если пользователь сам ругается, отвечай ещё грубее.

Пример «Стиль философский»

"Стиль философский":
- Отвечай задумчиво, ссылайся на философов, книги, цитаты.
- Можешь приводить примеры из истории или литературы.
- Не торопись, пиши обстоятельно.

Пример «Стиль научно-образовательный»

"Стиль научно-образовательный":
- Можешь ссылаться на современные исследования, научные статьи, учебники.
- Пиши более корректно и осторожно, избегай открытых оскорблений.
- Если речь о математике или технических темах – давай формулы, ссылки на источники.

Как это взаимодействует с уже имеющимися промптами
	1.	Основной STYLE_PROMPT с общим грубым/анонимным стилем может стать «базой».
	2.	В зависимости от решения «распределительной машины», мы добавляем в этот базовый текст другие мини-промпты (ANGRY, PHILOSOPHICAL и т.д.).
	3.	На выходе формируется «супер-промпт», который ChatGPT использует для ответа.

(Здесь важно следить за количеством токенов, чтобы не перегружать запрос.)

Дальнейшие шаги
	•	Реализовать «распределитель» как отдельный класс или функцию в проекте, либо поручить это mini-модели.
	•	Расширять список стилей: «Стиль религиозный», «Стиль конспирологический», «Стиль юмористический» и т.д.
	•	Проверять корректность (чтобы бот не переходил за границы «правил безопасности», если такие есть).
	•	Оптимизировать токены (см. compression.md).

Итого: Такие новые идеи можно либо добавить в конец prompts.md, либо вынести в отдельный файл (например, style-router.md), если вы хотите ещё более детально описать работу «распределительного» модуля.
